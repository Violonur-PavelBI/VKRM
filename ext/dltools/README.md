# dltools
Репозиторий для штучек, необходимых для обучения.  
По сути всё кроме модели, и отдельных оссобенностей алгоритмов должно быть тут.  
У всех объектов, которые могут и должны конфигурироваться должны быть соотвествующие датаклассы описаний.  

## Getting started
После клонирования можно поставить как Python пакет через pip.

Предпологается следующий состав:
- * Всякий нужный хлам (requirements.txt, Dockefile, setup.py, pre-commit.yaml, ci-cd и т.д)
- tests тесты штучек.
- dltools  
  - augs тут храним пресеты аугментаций
  - optim - Оптимизаторы.
    - schedulers Шедулеры
    - utils - Утилиты (например, подпарсер параметров модели, и создание групп параметров, отключения wd для bias и bn)
  - losses Функции Ошибки
    - base Базовый класс с общими интерфейсами, тут сразу предпологается механизм, спаренный с логерами, AverageMeter'ами и тому подобными штуками.
    - distutils Тулзы для синхронизации
    - combine Класс объединяющий несколько функций ошибки.
    - probabilistic (CE, BCE, KL,NLL и подобные)
      - CE
      - BCE
      - NLL
      - KL
      - FocalLoss
    - magnitude (L1, MSE, MAE, Huber и подобные)
    - statistical 
      - F1Loss (он же DiceLoss)
      - LovaszSoftmax
      - TverskiyLoss
    - detection **Пример!**
      - detection MIoU (И остальные)
      - MAP
    - segmentation **Пример!**
      - geometric
        - SurfaceLoss
        - Surface2EdgeLoss
      - boundary
        - HausdorffLoss
        - BoundaryLoss
      - region-statistic
        - SoftIoU (JaccardLoss)
        - SoftDICE (DiceLoss)
        - GDice
        - SqDice
        - SqJaccard
        - TverskiyLoss
      - utils
    - classification (может и не быть)
      - SoftMarginLoss
    - keypoints
  - metrics Метрики (По примеру ошибок) Сразу тут предпологается механизм, спаренный с логерами
    - base Базовый класс с общими интерфейсами, тут сразу предпологается механизм, спаренный с логерами, AverageMeter'ами и тому подобными штуками.
    - distutils Тулзы для синхронизации
    ...

  - writers Тут логгеры метрик и подобных штук (ray.tune.report тут где-то должен использоватся) Все writers должны иметь общий интерфейс, для того чтобы их легко было менять, (или дублировать) как перчатки.  
  - handlers - спец штуки обработчки, для пропуска шагов оптимизации, агрегирования ошибки, использование mixprecision и тому подобного.
  - policies\strategy - тут целые скрипты обучения под задачу из симпла
  - cfgutils - тут прообразы датаклассов, геттеры наших штучек.

## Всякие подробности

### augs
Предпологается иметь общие пресеты аугментаций для каждой задачи, для того, чтобы в экспериментах 


### Roadmap
Пора унифицировать! Для начала нужно собрать из simple\ofa датапровайдеры, ауги, лоссы, метрики, и кхе, кхе, **Визуализаторы**.
 - [ ] Сбор общего кода тут.
    - [ ] Аугментации. (Тут только мозаика, и интерфейсные штуки)
    - [ ] Датапровайдеры. ()
    - [ ] Метрики.
    - [ ] Лоссы.
 - [ ] Совместное review. Валидируем. 
 - [ ] Оформляем в issue предложения, и то что нужно согласно плану обсуждения 8.09.23. Ставим Сроки.
 - [ ] Прибираем за собой. Документируем код, пишем тесты важных вещей.

 
 Дополнительные вопросы, продублирую в issue:
  - [ ] I\O в случае HPO. Слишком много процессов загрузки\аугментирования подвешивают класстер, - другой вариант всё в память, в текущем виде блочит DDP. Нужна штука, заменяющая\оборачивающая DataLoader. 
  - [ ] MaxPossibleBatch Finder.
  - [ ] LrAdjuster.
  - [ ] Beta1Beta2Adjuster. 
  - [ ] Штуки проверяющие ограничения технологии.
  - [ ] Объединения препроцессингов, для расчета параметров взвешивания.
  - [ ] Альтернативные целевые метрики, их конфигурирование.
  - [ ] (Под вопросом) Встраивание текущих стопперов на основе `kernel_api.utils.rule._Rule`, и `kernel_api.utils.early_stopper.{stopper_cls_name}`
   